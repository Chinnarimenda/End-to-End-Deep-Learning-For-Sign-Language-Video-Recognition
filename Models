
#import tensorflow as tf
from tensorflow.keras.models import Model
from tensorflow.keras.layers import Input, TimeDistributed, LSTM, Dense, Dropout
from tensorflow.keras.applications import MobileNetV2

# Parameters
sequence_length = 30  # number of frames per video
image_size = (224, 224)
num_classes = 26  # for ISL alphabet

# Base CNN model (MobileNetV2)
cnn_base = MobileNetV2(include_top=False, weights='imagenet', input_shape=(224, 224, 3), pooling='avg')

# Freeze CNN layers
cnn_base.trainable = False

# Wrap CNN in TimeDistributed for video frames
video_input = Input(shape=(sequence_length, 224, 224, 3))
cnn_features = TimeDistributed(cnn_base)(video_input)

# LSTM for temporal modeling
x = LSTM(128, return_sequences=False)(cnn_features)
x = Dropout(0.5)(x)
x = Dense(64, activation='relu')(x)
output = Dense(num_classes, activation='softmax')(x)

# Final model
model = Model(inputs=video_input, outputs=output)
model.compile(optimizer='adam', loss='categorical_crossentropy', metrics=['accuracy'])

model.summary()
